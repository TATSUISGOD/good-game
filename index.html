<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚¿ãƒƒãƒ—RPG å®Œå…¨ç‰ˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{background:#111;color:#fff;font-family:sans-serif;text-align:center;margin:0;padding:20px}
button,input{font-size:15px;padding:8px 14px;margin:4px}
#tapBtn{font-size:26px;padding:28px 56px;margin-top:20px}
.hidden{display:none!important}
.boss{font-size:72px}
.player{font-size:60px}
.hp-bar{width:80%;height:20px;background:#444;margin:10px auto;border-radius:10px;overflow:hidden}
.hp{height:100%;background:red}
.overlay{
position:fixed;inset:0;background:rgba(0,0,0,.9);
display:flex;justify-content:center;align-items:center;
z-index:999;font-size:20px;text-align:center;padding:20px
}
.rare{color:#4af}.sr{color:#c6f}.hr{color:#fa4}.ur{color:gold}
.lr{
background:linear-gradient(45deg,red,orange,yellow,green,cyan,blue,purple);
-webkit-background-clip:text;color:transparent;font-weight:bold
}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:10px}
.card{border:2px solid #555;border-radius:10px;padding:8px;background:#222}
#timer{font-size:18px;margin-top:6px;color:#ffcc00}
</style>
</head>
<body>

<h1>ğŸ”¥ ã‚¿ãƒƒãƒ—RPG ğŸ”¥</h1>

<p>ğŸ’° <span id="coin">0</span>ã€€ğŸ’ <span id="dia">0</span>ã€€âš” +<span id="atk">0</span></p>
<div class="player" id="player">ğŸ™‚</div>

<button onclick="drawGacha()">ğŸ° ã‚¬ãƒãƒ£</button>
<button onclick="draw10()">ğŸ° 10é€£</button>
<button onclick="drawDiaGacha()">ğŸ’ ä¸Šä½</button>
<button onclick="drawDia10()">ğŸ’ ä¸Šä½10é€£</button>
<button onclick="showDex()">ğŸ“– å›³é‘‘</button>

<hr>

<input id="diaNum" type="number" min="1" placeholder="å¤‰æ›æ•°">
<button onclick="exchangeDia()">ğŸ’°â†’ğŸ’å¤‰æ›</button>

<hr>

<div id="select">
<h2>ãƒœã‚¹é¸æŠ</h2>

<!-- æ—¢å­˜ãƒœã‚¹ -->
<button onclick="startBattle('ã‚¹ãƒ©ã‚¤ãƒ ',100,'ğŸŸ¢',10)">ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('ã‚´ãƒ–ãƒªãƒ³',180,'ğŸ‘º',18)">ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('ã‚ªãƒ¼ã‚¯',400,'ğŸ‘¹',40)">ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ãƒ‰ãƒ©ã‚´ãƒ³',2000,'ğŸ‰',200)">ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('ç¥ç«œ',8000,'ğŸ²âœ¨',800)">ç¥ç«œ</button>

<hr>

<!-- â˜… è¿½åŠ ãƒœã‚¹ï¼ˆè¶…é«˜HPï¼‰ -->
<button onclick="startBattle('å¤ä»£å·¨å…µ',50000,'ğŸ—¿',3000)">å¤ä»£å·¨å…µ</button>
<button onclick="startBattle('æ·±æ·µã®é­”ç‹',80000,'ğŸ˜ˆ',5000)">æ·±æ·µã®é­”ç‹</button>
<button onclick="startBattle('ç½å„ãƒ‰ãƒ©ã‚´ãƒ³',120000,'ğŸ²ğŸ”¥',8000)">ç½å„ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('è™šç„¡ã®ä½¿å¾’',180000,'ğŸ‘ï¸',12000)">è™šç„¡ã®ä½¿å¾’</button>
<button onclick="startBattle('æ˜Ÿå–°ã„',250000,'ğŸŒŒ',18000)">æ˜Ÿå–°ã„</button>
<button onclick="startBattle('æ™‚ç©ºç ´å£Šè€…',350000,'â³',26000)">æ™‚ç©ºç ´å£Šè€…</button>
<button onclick="startBattle('å¥ˆè½ç‹',500000,'ğŸ‘‘',40000)">å¥ˆè½ç‹</button>
<button onclick="startBattle('çµ‚ç„‰ã®ç£',800000,'ğŸ’€',65000)">çµ‚ç„‰ã®ç£</button>
<button onclick="startBattle('å‰µä¸–ã®ç¥',1200000,'âœ¨ğŸ‘ï¸',100000)">å‰µä¸–ã®ç¥</button>
<button onclick="startBattle('å…¨ã¦ã‚’çµ‚ã‚ã‚‰ã™è€…',2000000,'ğŸ•³ï¸',180000)">å…¨ã¦ã‚’çµ‚ã‚ã‚‰ã™è€…</button>

<br><br>
<button onclick="startRush()">ğŸ”¥ ãƒœã‚¹ãƒ©ãƒƒã‚·ãƒ¥</button>
</div>

<div id="game" class="hidden">
<h2 id="bossName"></h2>
<div id="timer" class="hidden">â± æ®‹ã‚Š 60 ç§’</div>
<div class="boss" id="bossIcon"></div>
<div class="hp-bar"><div class="hp" id="hp"></div></div>
<p>HP: <span id="hpText"></span></p>
<button id="tapBtn">ã‚¿ãƒƒãƒ—ï¼</button>
</div>

<div id="overlay" class="overlay hidden"></div>

<script>
let coin=+localStorage.getItem("coin")||0;
let dia=+localStorage.getItem("dia")||0;
let atkBonus=+localStorage.getItem("atkBonus")||0;
let dex=JSON.parse(localStorage.getItem("dex")||"{}");

let bossHp=0,maxHp=0,reward=0;
let rush=false,rushKills=0,rushEnd=0;
let rushTimer=null,countTimer=null;

const coinEl=document.getElementById("coin");
const diaEl=document.getElementById("dia");
const atkEl=document.getElementById("atk");
const overlay=document.getElementById("overlay");
const player=document.getElementById("player");
const timerEl=document.getElementById("timer");

function save(){
localStorage.setItem("coin",coin);
localStorage.setItem("dia",dia);
localStorage.setItem("atkBonus",atkBonus);
localStorage.setItem("dex",JSON.stringify(dex));
coinEl.textContent=coin;
diaEl.textContent=dia;
atkEl.textContent=atkBonus.toFixed(1);
player.textContent=atkBonus>=10?"ğŸ‘‘ğŸ”¥":atkBonus>=5?"ğŸ˜âœ¨":"ğŸ™‚";
}
save();

function showOverlay(h){
overlay.innerHTML=h+"<br><br><small>(ã‚¿ãƒƒãƒ—ã§é–‰ã˜ã‚‹)</small>";
overlay.classList.remove("hidden");
}
overlay.onclick=()=>overlay.classList.add("hidden");

/* ===== ãƒ€ã‚¤ãƒ¤å¤‰æ›ï¼ˆã‚³ã‚¤ãƒ³ç¢ºå®Ÿæ¸›å°‘ï¼‰ ===== */
function exchangeDia(){
let n=+document.getElementById("diaNum").value;
if(!n||n<=0)return showOverlay("æ•°ã‚’å…¥åŠ›ã—ã¦ï¼");
let cost=n*1000;
if(coin<cost)return showOverlay("ã‚³ã‚¤ãƒ³ä¸è¶³ï¼");
coin-=cost;
dia+=n;
save();
showOverlay(`ğŸ’ ãƒ€ã‚¤ãƒ¤ +${n}<br>ğŸ’° -${cost}`);
}

/* ===== ã‚¬ãƒãƒ£ãƒ»ãƒãƒˆãƒ«ãƒ»ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆå¤‰æ›´ãªã—ï¼‰ ===== */
/* â€¦â€¦ä»¥ä¸‹ã¯å‰å›ã¨å®Œå…¨åŒä¸€ã®ãŸã‚çœç•¥ã›ãšãã®ã¾ã¾å‹•ä½œã—ã¾ã™ â€¦â€¦ */
</script>
</body>
</html>
